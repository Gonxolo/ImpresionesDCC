<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Impresiones DCC</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>
<body>
<div class="d-flex flex-column min-vh-100 p-2 justify-content-center align-items-center">
<div class="container" style="background-color: rgba(0, 0, 0, 0.1)">

    <label for="nombre-archivo-pdf">Nombre del archivo en formato PDF</label>
    <input id="nombre-archivo-pdf" type="text" placeholder="filename.pdf" value="filename.pdf">

    <br><br>

    <label for="nombre-archivo-ps">Nombre del archivo PS de salida (puedes dejar el nombre por defecto)</label>
    <input id="nombre-archivo-ps" type="text" placeholder="out.ps" value="out.ps">

    <br><br>

    <label for="impresion-doble-cara">Impresión a doble cara</label>
    <input id="impresion-doble-cara" type="checkbox" onchange="checkBorde()" checked>

    <br><br>

    <div id="esconder-borde-impresion">
    <label for="borde-impresion">Impresión por borde</label>
    <select id="borde-impresion">
        <option value="largo">Largo</option>
        <option value="corto">Corto</option>
    </select>

    </div>

    <br><br>


    <label for="lugar-impresion">Lugar de impresión</label>
    <select id="lugar-impresion">
        <option value="toqui">Toqui</option>
        <option value="salita">Salita</option>
    </select>

    <br><br>

    <button onclick="rehacerComando()">Generar Comando</button>

    <br><br>

    <div id="display-comando" hidden>
        Comando (copia este en tu terminal de anakena):
    </div>

    <div id="confirmacion-copiado" class="alert alert-success" hidden>
        Comando copiado!
    </div>

    <code id="comando-consola"></code>

    <br><br>
    <button id="copy-button" onclick="copyToClipboard()" hidden>Copiar comando</button>
    <br><br>

    <footer class="bg-light text-center text-lg-start">
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        Toda la informacion en esta pagina fue obtenida de
        <a class="fw-bold" href="https://faq.cadcc.cl/es/latest/FAQ%20Impresoras/">Impresiones - FAQ CaDCC</a>
        </div>
    </footer>
</div>
</div>

</body>

<script>

    function checkBorde(){
        document.getElementById("esconder-borde-impresion").hidden = (!document.getElementById("impresion-doble-cara").checked);
    }

    function rehacerComando(){
        // Limpiamos el comando
        document.getElementById("comando-consola").innerText = "";

        document.getElementById("confirmacion-copiado").hidden = true;

        document.getElementById("display-comando").hidden = false;

        document.getElementById("copy-button").hidden = false;

        let nombreArchivoPDF = document.getElementById("nombre-archivo-pdf").value;

        let nuevoComando = "";

        const nombreArchivoPS = document.getElementById("nombre-archivo-ps").value;

        nuevoComando += `pdf2ps ${nombreArchivoPDF} ${nombreArchivoPS} && `;

        // Volvemos a buscar los nombres
        if(document.getElementById("impresion-doble-cara").checked){
            nuevoComando += "duplex "

            if(document.getElementById("borde-impresion").value === 'corto'){
                nuevoComando += "-l "
            }

            nuevoComando += `${nombreArchivoPS}|lpr`;

        } else {
            nuevoComando += `lpr ${nombreArchivoPS}`;
        }

        if (document.getElementById("lugar-impresion").value === "salita"){
            nuevoComando += " -P hp335";
        }

        document.getElementById("comando-consola").innerText = nuevoComando;

    }

    function copyToClipboard() {
        // Get the text field
        var copyText = document.getElementById("comando-consola");

        // Copy the text inside the text field
        navigator.clipboard.writeText(copyText.innerText);

        // Alert the copied text
        document.getElementById("confirmacion-copiado").hidden = false;
    }

</script>

</html>